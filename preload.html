<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Battle Simulator v3.0</title>
    <style>
        :root {
            --hive-blue: #00f7ff;
            --dna-pink: #ff00ff;
        }

        body {
            background: #000;
            color: white;
            font-family: Arial, sans-serif;
        }

        .enemy-type-indicator {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 1.2rem;
            text-shadow: 0 0 10px var(--dna-pink);
        }

        .cooldown-overlay {
            position: absolute;
            background: rgba(0,0,0,0.7);
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            display: none;
            border-radius: 4px;
        }

        .upgrade-menu {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #000;
            padding: 2rem;
            border: 2px solid var(--hive-blue);
            z-index: 1000;
            display: none;
        }

        .skill-buttons {
            display: grid;
            gap: 10px;
            padding: 20px;
        }

        .skill-button {
            background: var(--hive-blue);
            border: none;
            padding: 15px 25px;
            color: black;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s;
        }

        #audio-toggle {
            position: fixed;
            top: 10px;
            left: 10px;
            padding: 5px 10px;
            background: var(--hive-blue);
            border: none;
            color: white;
        }

        @media (max-width: 768px) {
            .skill-button {
                padding: 12px 20px;
                font-size: 1.1rem;
            }
            #mobile-controls {
                display: flex;
                gap: 10px;
                margin-top: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="enemy-type-indicator"></div>
    <button id="audio-toggle">Toggle Sound</button>

    <div class="skill-buttons">
        <button class="skill-button" data-skill="Quantum Strike">Quantum Strike</button>
        <button class="skill-button" data-skill="Neural Shield">Neural Shield</button>
    </div>

    <div id="mobile-controls" style="display: none;">
        <button class="skill-button mobile-btn">SKILL 1</button>
        <button class="skill-button mobile-btn">SKILL 2</button>
    </div>

    <div class="upgrade-menu">
        <h3>Choose Upgrade</h3>
        <div id="upgrade-options"></div>
    </div>

    <script>
        let gameState = {
            score: 0,
            upgrades: [],
            currentWave: 1,
            audioEnabled: true,
            enemyTypes: ['Brute', 'Mage', 'Healer'],
            critMultiplier: 1
        };

        let battlerHero = {
            attack: 10,
            defense: 5,
            critChance: 0.1
        };

        let entropyEntity;

        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(frequency, type = 'square') {
            if(!gameState.audioEnabled) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.type = type;
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.3);
        }

        class Enemy {
            constructor(type, wave) {
                this.type = type;
                this.hp = 50 + wave * 10;
                this.attack = 8 + wave * 2;
                this.defense = Math.floor(wave / 5);
                
                switch(type) {
                    case 'Brute':
                        this.hp *= 1.5;
                        break;
                    case 'Mage':
                        this.attack *= 1.3;
                        break;
                    case 'Healer':
                        this.hp += wave * 5;
                        break;
                }
            }
        }

        const skillTree = [
            { 
                name: 'Quantum Strike', 
                multiplier: 2,
                cooldown: 15000,
                duration: 10000,
                type: 'damage',
                cooldownActive: false
            },
            { 
                name: 'Neural Shield', 
                multiplier: 0.5,
                cooldown: 20000,
                duration: 8000,
                type: 'defense',
                cooldownActive: false
            }
        ];

        function activateSkill(skill) {
            if(skill.cooldownActive) return;
            
            playSound(800, 'sine');
            
            switch(skill.type) {
                case 'damage':
                    gameState.critMultiplier = skill.multiplier;
                    break;
                case 'defense':
                    battlerHero.defense *= skill.multiplier;
                    break;
            }
            
            skill.cooldownActive = true;
            showCooldown(skill);
            
            setTimeout(() => {
                resetSkill(skill);
            }, skill.duration);
        }

        function showCooldown(skill) {
            const btn = document.querySelector(`[data-skill="${skill.name}"]`);
            const overlay = document.createElement('div');
            overlay.className = 'cooldown-overlay';
            btn.appendChild(overlay);
            
            let remaining = skill.cooldown;
            const interval = setInterval(() => {
                remaining -= 100;
                overlay.style.display = 'block';
                overlay.style.height = `${(remaining / skill.cooldown) * 100}%`;
                if(remaining <= 0) {
                    clearInterval(interval);
                    overlay.remove();
                    skill.cooldownActive = false;
                }
            }, 100);
        }

        function resetSkill(skill) {
            switch(skill.type) {
                case 'damage':
                    gameState.critMultiplier = 1;
                    break;
                case 'defense':
                    battlerHero.defense /= skill.multiplier;
                    break;
            }
        }

        const upgradesList = [
            { cost: 100, effect: 'attack', value: 5 },
            { cost: 150, effect: 'defense', value: 3 },
            { cost: 200, effect: 'critChance', value: 0.05 }
        ];

        function showUpgrades() {
            const container = document.getElementById('upgrade-options');
            container.innerHTML = '';
            
            upgradesList.forEach(upgrade => {
                const btn = document.createElement('button');
                btn.className = 'skill-button';
                btn.innerHTML = `
                    ${upgrade.effect} +${upgrade.value}<br>
                    <small>Cost: ${upgrade.cost} XP</small>
                `;
                btn.onclick = () => purchaseUpgrade(upgrade);
                container.appendChild(btn);
            });
            
            document.querySelector('.upgrade-menu').style.display = 'block';
        }

        function purchaseUpgrade(upgrade) {
            if(gameState.score >= upgrade.cost) {
                gameState.score -= upgrade.cost;
                battlerHero[upgrade.effect] += upgrade.value;
                updateQuantumStats();
                document.querySelector('.upgrade-menu').style.display = 'none';
            }
        }

        function commenceWave() {
            const enemyType = gameState.enemyTypes[Math.floor(Math.random() * gameState.enemyTypes.length)];
            entropyEntity = new Enemy(enemyType, gameState.currentWave);
            document.querySelector('.enemy-type-indicator').textContent = `${enemyType} Enemy`;
        }

        function updateQuantumStats() {
            document.getElementById('attack-value').textContent = battlerHero.attack;
            document.getElementById('defense-value').textContent = battlerHero.defense;
        }

        function initMobileControls() {
            if(/Mobi|Android/i.test(navigator.userAgent)) {
                document.getElementById('mobile-controls').style.display = 'flex';
                document.querySelectorAll('.mobile-btn').forEach((btn, i) => {
                    btn.onclick = () => {
                        const skills = document.querySelectorAll('[data-skill]');
                        if(skills[i]) skills[i].click();
                    };
                });
            }
        }

        document.querySelectorAll('[data-skill]').forEach(button => {
            const skillName = button.dataset.skill;
            const skill = skillTree.find(s => s.name === skillName);
            button.addEventListener('click', () => activateSkill(skill));
        });

        document.getElementById('audio-toggle').addEventListener('click', () => {
            gameState.audioEnabled = !gameState.audioEnabled;
        });

        initMobileControls();
        commenceWave();
    </script>
</body>
</html>
