<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Auto Battler Game - Upgraded Version</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    .container {
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .hidden {
      display: none;
    }
    h1, h2, h3 {
      color: #2e3d49;
    }
    .button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      margin: 10px;
    }
    .button:hover {
      background-color: #45a049;
    }
    .bar {
      width: 100%;
      background-color: #ddd;
      border-radius: 5px;
      margin: 10px 0;
      height: 20px;
    }
    .bar-fill {
      height: 100%;
      border-radius: 5px;
      background-color: #4CAF50;
      transition: width 0.3s ease;
    }
    #gameOverScreen {
      position: fixed;
      top:0;
      left:0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      color: white;
      font-size: 2em;
      z-index: 10;
    }
    /* Simple inline notification styling */
    #notification {
      color: #2e3d49;
      font-size: 1.2em;
      margin: 10px;
    }
  </style>
</head>
<body>
  <!-- Start Page -->
  <div id="startPage" class="container">
    <h1>Welcome to the Auto Battler Game!</h1>
    <p>Choose your character and prepare to fight endless enemies!</p>
    <button class="button" id="startGameBtn">Start Game</button>
  </div>

  <!-- Game Page -->
  <div id="gamePage" class="hidden">
    <!-- Character Selection -->
    <div id="playerMenu" class="container">
      <h2>Pick Your Character</h2>
      <button class="button" data-character="Warrior">Warrior üó°Ô∏è</button>
      <button class="button" data-character="Archer">Archer üèπ</button>
      <button class="button" data-character="Mage">Mage üîÆ</button>
    </div>

    <!-- Game Area -->
    <div id="gameArea" class="container hidden">
      <!-- Player Battle Stats -->
      <div id="fightStats">
        <p id="playerName"></p>
        <p>Health: <span id="playerHealth"></span></p>
        <div class="bar">
          <div id="playerHealthBar" class="bar-fill" style="width: 100%;"></div>
        </div>
        <p>Money: <span id="playerMoney"></span></p>
      </div>

      <!-- Inline notification for battle events -->
      <div id="notification"></div>

      <!-- Store Menu for Upgrades -->
      <div id="storeMenu" class="hidden">
        <h3>Store - Upgrade Your Stats</h3>
        <div>
          <button class="button" id="upgradeHealthBtn">Upgrade Health (10 Gold)</button>
        </div>
        <div>
          <button class="button" id="upgradeAttackBtn">Upgrade Attack (15 Gold)</button>
        </div>
        <div>
          <button class="button" id="upgradeDefenseBtn">Upgrade Defense (20 Gold)</button>
        </div>
        <button class="button" id="startBattleBtn">Start Battle</button>
      </div>

      <!-- Enemy Encounter -->
      <div id="enemyStats" class="hidden">
        <h3 id="enemyName"></h3>
        <p>Health: <span id="enemyHealth"></span></p>
        <div class="bar">
          <div id="enemyHealthBar" class="bar-fill" style="width: 100%;"></div>
        </div>
        <button class="button" id="attackEnemyBtn">Attack Enemy</button>
      </div>
    </div>
  </div>

  <!-- Game Over Screen -->
  <div id="gameOverScreen" class="hidden">
    <p id="gameOverMessage"></p>
    <button class="button" id="restartGameBtn">Restart Game</button>
  </div>

  <script>
    'use strict';
    // Grab DOM elements
    const startPage = document.getElementById('startPage');
    const gamePage = document.getElementById('gamePage');
    const playerMenu = document.getElementById('playerMenu');
    const gameArea = document.getElementById('gameArea');
    const storeMenu = document.getElementById('storeMenu');
    const enemyStatsDiv = document.getElementById('enemyStats');
    const gameOverScreen = document.getElementById('gameOverScreen');
    const gameOverMessage = document.getElementById('gameOverMessage');
    const notificationEl = document.getElementById('notification');
    
    const playerNameDisplay = document.getElementById('playerName');
    const playerHealthDisplay = document.getElementById('playerHealth');
    const playerHealthBar = document.getElementById('playerHealthBar');
    const playerMoneyDisplay = document.getElementById('playerMoney');
    
    const enemyNameDisplay = document.getElementById('enemyName');
    const enemyHealthDisplay = document.getElementById('enemyHealth');
    const enemyHealthBar = document.getElementById('enemyHealthBar');
    
    const startGameBtn = document.getElementById('startGameBtn');
    const attackEnemyBtn = document.getElementById('attackEnemyBtn');
    const upgradeHealthBtn = document.getElementById('upgradeHealthBtn');
    const upgradeAttackBtn = document.getElementById('upgradeAttackBtn');
    const upgradeDefenseBtn = document.getElementById('upgradeDefenseBtn');
    const startBattleBtn = document.getElementById('startBattleBtn');
    const restartGameBtn = document.getElementById('restartGameBtn');
    
    // Game variables
    let gameLevel = 1;
    let player = {
      name: '',
      stats: { maxHealth: 100, health: 100, attack: 20, defense: 5, money: 0, level: 1 }
    };
    let enemy = {
      stats: { maxHealth: 100, health: 100, attack: 15, defense: 3, level: 1 }
    };
    
    // Utility: show notification text
    function notify(message, duration = 2000) {
      notificationEl.innerText = message;
      setTimeout(() => notificationEl.innerText = '', duration);
    }
    
    // Start the game: show game page
    startGameBtn.addEventListener('click', () => {
      startPage.classList.add('hidden');
      gamePage.classList.remove('hidden');
    });
    
    // Character selection: event delegation
    playerMenu.addEventListener('click', (e) => {
      if(e.target.matches('button[data-character]')) {
        const character = e.target.getAttribute('data-character');
        createPlayer(character);
      }
    });
    
    function createPlayer(character) {
      player.name = character;
      if(character === 'Warrior') {
        player.stats.attack = 25;
        player.stats.defense = 10;
        player.stats.maxHealth = 120;
      } else if(character === 'Archer') {
        player.stats.attack = 20;
        player.stats.defense = 5;
        player.stats.maxHealth = 100;
      } else if(character === 'Mage') {
        player.stats.attack = 15;
        player.stats.defense = 3;
        player.stats.maxHealth = 90;
      }
      player.stats.health = player.stats.maxHealth;
      player.stats.money = 0;
      player.stats.level = 1;
      
      updatePlayerDisplay();
      playerMenu.classList.add('hidden');
      storeMenu.classList.remove('hidden');
      gameArea.classList.remove('hidden');
      notify(`You selected ${player.name}!`);
    }
    
    function updatePlayerDisplay() {
      playerNameDisplay.innerText = `${player.name} - Level ${player.stats.level}`;
      playerHealthDisplay.innerText = `${player.stats.health} / ${player.stats.maxHealth}`;
      playerHealthBar.style.width = `${(player.stats.health / player.stats.maxHealth) * 100}%`;
      playerMoneyDisplay.innerText = player.stats.money;
    }
    
    function startBattle() {
      enemy.stats.level = gameLevel;
      enemy.stats.maxHealth = 100 + (gameLevel - 1) * 20;
      enemy.stats.health = enemy.stats.maxHealth;
      enemy.stats.attack = 15 + (gameLevel - 1) * 2;
      enemy.stats.defense = 5 + (gameLevel - 1);
      
      enemyNameDisplay.innerText = `Enemy - Level ${enemy.stats.level}`;
      enemyHealthDisplay.innerText = `${enemy.stats.health} / ${enemy.stats.maxHealth}`;
      enemyHealthBar.style.width = '100%';
      
      storeMenu.classList.add('hidden');
      enemyStatsDiv.classList.remove('hidden');
      notify("Battle Start!");
    }
    
    startBattleBtn.addEventListener('click', startBattle);
    
    function updateEnemyDisplay() {
      enemyHealthDisplay.innerText = `${enemy.stats.health} / ${enemy.stats.maxHealth}`;
      enemyHealthBar.style.width = `${(enemy.stats.health / enemy.stats.maxHealth) * 100}%`;
    }
    
    // Player attacks enemy
    attackEnemyBtn.addEventListener('click', () => {
      performPlayerAttack();
    });
    
    function performPlayerAttack() {
      const damageToEnemy = Math.max(0, player.stats.attack - enemy.stats.defense);
      enemy.stats.health = Math.max(0, enemy.stats.health - damageToEnemy);
      updateEnemyDisplay();
      notify(`You dealt ${damageToEnemy} damage!`);
      
      if(enemy.stats.health === 0) {
        handleEnemyDefeated();
      } else {
        // Enemy attacks after a short delay (e.g., 1 second)
        setTimeout(enemyAttack, 1000);
      }
    }
    
    function enemyAttack() {
      const damageToPlayer = Math.max(0, enemy.stats.attack - player.stats.defense);
      player.stats.health = Math.max(0, player.stats.health - damageToPlayer);
      updatePlayerDisplay();
      notify(`Enemy dealt ${damageToPlayer} damage!`);
      
      if(player.stats.health === 0) {
        endGame('You were defeated!');
      }
    }
    
    function handleEnemyDefeated() {
      const reward = 20 + gameLevel * 5;
      player.stats.money += reward;
      updatePlayerDisplay();
      notify(`Enemy defeated! You gained ${reward} gold.`, 2500);
      gameLevel++;
      // Return to store menu for upgrades
      enemyStatsDiv.classList.add('hidden');
      storeMenu.classList.remove('hidden');
    }
    
    // Upgrade buttons
    upgradeHealthBtn.addEventListener('click', () => {
      if(player.stats.money >= 10) {
        player.stats.money -= 10;
        player.stats.maxHealth += 10;
        player.stats.health += 10;
        updatePlayerDisplay();
        notify("Health upgraded!");
      } else {
        notify('Not enough gold!');
      }
    });
    
    upgradeAttackBtn.addEventListener('click', () => {
      if(player.stats.money >= 15) {
        player.stats.money -= 15;
        player.stats.attack += 5;
        updatePlayerDisplay();
        notify("Attack upgraded!");
      } else {
        notify('Not enough gold!');
      }
    });
    
    upgradeDefenseBtn.addEventListener('click', () => {
      if(player.stats.money >= 20) {
        player.stats.money -= 20;
        player.stats.defense += 3;
        updatePlayerDisplay();
        notify("Defense upgraded!");
      } else {
        notify('Not enough gold!');
      }
    });
    
    function endGame(message) {
      enemyStatsDiv.classList.add('hidden');
      storeMenu.classList.add('hidden');
      gameOverMessage.innerText = message;
      gameOverScreen.classList.remove('hidden');
    }
    
    // Restart game resets all stats and returns to store menu
    restartGameBtn.addEventListener('click', () => {
      gameLevel = 1;
      player.stats = { maxHealth: 100, health: 100, attack: 20, defense: 5, money: 0, level: 1 };
      enemy.stats = { maxHealth: 100, health: 100, attack: 15, defense: 3, level: 1 };
      gameOverScreen.classList.add('hidden');
      storeMenu.classList.remove('hidden');
      updatePlayerDisplay();
      notify("Game restarted!");
    });
    
    // Optional: Keyboard control ‚Äì press "A" to attack when enemy is visible.
    document.addEventListener('keydown', (e) => {
      if(!enemyStatsDiv.classList.contains('hidden') && e.key.toLowerCase() === 'a') {
        performPlayerAttack();
      }
    });
  </script>
</body>
</html>

